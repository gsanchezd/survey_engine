<div class="survey-container">
  <header class="survey-header">
    <h1><%= t('survey_engine.surveys.index.title') %></h1>
  </header>

  <% if @current_email.present? %>
    <div class="survey-alert survey-alert-success">
      <strong><%= t('survey_engine.surveys.index.signed_in_as') %></strong> <%= @current_email %>
    </div>
  <% end %>

  <% if @surveys.any? %>
    <div class="survey-list">
      <% @surveys.each do |survey| %>
        <article class="survey-card">
          <h2><%= survey.title %></h2>
          <p><%= survey.description %></p>
          
          <div class="survey-meta">
            <span><strong><%= t('survey_engine.surveys.index.questions') %></strong> <%= survey.questions_count %></span>
            <span><strong><%= t('survey_engine.surveys.index.participants') %></strong> <%= survey.participants_count %></span>
            <span><strong><%= t('survey_engine.surveys.index.status') %></strong> <span class="survey-status"><%= t("survey_engine.statuses.#{survey.status}") %></span></span>
          </div>
          
          <div class="survey-actions">
            <% if survey.can_receive_responses? %>
              <% if @current_email.present? && @completed_surveys&.dig(survey.id) %>
                <span class="survey-btn survey-btn-completed">
                  <%= t('survey_engine.surveys.index.completed') %>
                </span>
                <%= link_to t('survey_engine.surveys.index.view_results'), completed_survey_path(survey.uuid), 
                    class: "survey-btn survey-btn-success" %>
              <% else %>
                <% if @current_email.present? %>
                  <%= link_to t('survey_engine.surveys.index.continue_survey'), survey_path(survey.uuid), 
                      class: "survey-btn survey-btn-primary" %>
                <% else %>
                  <%= link_to t('survey_engine.surveys.index.take_survey'), survey_path(survey.uuid), 
                      class: "survey-btn survey-btn-primary" %>
                <% end %>
              <% end %>
            <% else %>
              <span class="survey-text-muted"><%= t('survey_engine.surveys.index.survey_not_available') %></span>
            <% end %>
            
            <% if survey.participants_count > 0 %>
              <%= link_to t('survey_engine.surveys.index.view_results_icon'), results_survey_path(survey.uuid), 
                  class: "survey-btn survey-btn-secondary" %>
            <% else %>
              <span class="survey-btn survey-btn-disabled"><%= t('survey_engine.surveys.index.no_results_yet') %></span>
            <% end %>
          </div>
        </article>
      <% end %>
    </div>
  <% else %>
    <div class="survey-empty-state">
      <h3><%= t('survey_engine.surveys.index.no_surveys') %></h3>
      <p><%= t('survey_engine.surveys.index.no_surveys_message') %></p>
      <p class="survey-helper-text"><%= t('survey_engine.surveys.index.helper_text') %></p>
    </div>
  <% end %>
</div>